if safe_ckpt:
    print(f"ğŸ”„ Found checkpoint folder: {safe_ckpt}")
    trainer_state_path = os.path.join(safe_ckpt, "trainer_state.json")

    if os.path.exists(trainer_state_path):
        # Full Trainer checkpoint (rare in this setup)
        print("ğŸ§  Full checkpoint detected â€” resuming complete training state...")
        trainer.train(resume_from_checkpoint=safe_ckpt)
    else:
        # Only adapter weights exist
        print("âš ï¸ No trainer_state.json found â€” loading adapter weights only.")
        model = PeftModel.from_pretrained(model, safe_ckpt)
        trainer.model = model
        print("ğŸ” Continuing training from adapter weights...")
        trainer.train()
else:
    print("âœ¨ Starting fresh training...")
    trainer.train()
