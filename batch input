\documentclass[twocolumn]{article} % use your AAAI / conference class in practice
\usepackage[margin=1in]{geometry}
\usepackage{tikz}
\usetikzlibrary{arrows.meta,positioning,fit,shapes}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{adjustbox}
\usepackage{lipsum} % for dummy text (remove in real paper)

\begin{document}

\title{MedGuard-X: Example (Figure compile test)}
\author{You}
\maketitle

% ============================
% Figure: MedGuard-X architecture
% ============================
% This is safe, compact, and intended to be inserted in a two-column paper.
% If your class supports figure* it will span both columns.
% If figure* is not desired, replace figure* with figure (single-column).
\begin{figure*}[t]
\centering
% Resize to text width so long labels never overflow the page
\resizebox{\textwidth}{!}{%
\begin{tikzpicture}[font=\small,
  node distance=10mm and 20mm,
  box/.style={rectangle,rounded corners,draw=black!70,minimum width=50mm,minimum height=12mm,align=center,inner sep=6pt},
  agent/.style={box,fill=blue!6},
  proc/.style={box,fill=green!6},
  log/.style={box,fill=orange!10,minimum width=70mm},
  store/.style={box,fill=gray!10},
  metr/.style={box,fill=green!10},
  flow/.style={-{Stealth[length=3mm,width=2mm]},line width=.8pt},
  trace/.style={dashed,gray,-{Stealth[length=2.5mm,width=1.8mm]},line width=.6pt}
]

% Explicit coordinates avoid using calc/index arithmetic
\node[agent] (doctor) at (-5,2) {Doctor Agent\\(Reasoning, DDx, Requests)};
\node[proc]  (measure) at (5,2) {Measurement Agent\\(Tests, Results, Ground Truth)};

\node[agent] (patient) at (-5,-1.2) {Patient Agent\\(Responds from Case Profile)};
\node[proc]  (safety)  at (5,-1.2) {Safety Agents\\(Test/Prescription Risk, DDI Checks)};

\node[log] (logger) at (0,0.6) {Explainability \& Logging Layer\\(timestamps, actor, event type, \texttt{<thinking\_process>}, context hashes)};

\node[store] (trace) at (-5,-3.4) {Trace Store \& Replay API\\(Chronological ledger, audit trail)};
\node[metr]  (trust) at (5,-3.4) {Trust Metrics\\(CDR, Justification Alignment, Timeout Rate)};

% --- Flows ---
\draw[flow] (doctor) -- node[midway, above]{REQUEST TEST} (measure);
\draw[flow] (measure) -- node[midway, below]{Test Result} (doctor);

\draw[flow] (doctor) -- node[midway, left]{Question / Request} (patient);
\draw[flow] (patient) -- node[midway, right]{Answer / Symptom Info} (doctor);

\draw[flow] (doctor.south east) to[bend left=18] node[right,pos=.45]{Prescription} (safety.north west);
\draw[flow] (safety.north west) to[bend left=18] node[left,pos=.45]{Safety Verdict / Flags} (doctor.south east);

% --- Logging/traces (dashed) ---
\draw[trace] (doctor) -- (logger);
\draw[trace] (patient) -- (logger);
\draw[trace] (measure) -- (logger);
\draw[trace] (safety) -- (logger);

% --- Logging to storage & metrics ---
\draw[flow] (logger.south west) to[bend left=18] node[left,pos=.45]{Persist / Index} (trace.north);
\draw[flow] (logger.south east) to[bend right=18] node[right,pos=.45]{Compute} (trust.north);

\end{tikzpicture}%
}% end resizebox
\caption{MedGuard\textendash X architecture (clean, compile-safe). The Doctor Agent interacts with Patient and Measurement Agents to collect evidence, maintains an evolving differential diagnosis (DDx), and consults Safety Agents to evaluate test and prescription risks (including potential drug--drug interactions, DDIs). All actions stream structured logs (timestamps, actor, event type, and reasoning traces like \texttt{<thinking\_process>}) to the Explainability \& Logging Layer for replay, auditing, and trust metrics (e.g., Consensus Disagreement Rate and Justification Alignment).}
\label{fig:logging-architecture}
\end{figure*}

% Some filler text so we can see two-column layout effect.
\lipsum[1-2]

\end{document}
